# çƒ­æ›´æ–°

## electron-asar-hot-updater

 `npm install electron-asar-hot-updater -s`

[electron-vue Demo](https://github.com/yansenlei/asar-update-project)

## æœåŠ¡ç«¯ä»£ç ç¤ºä¾‹ï¼ˆnode.jså®žçŽ°æ–‡ä»¶ä¸‹è½½ï¼‰

```javascript
const hostname = '0.0.0.0';
const port = 3176;
const http = require('http');
const server = http.createServer();
const fs = require('fs');
const path = require('path');

server.listen(port, hostname, () => {
    let msg = `å¼€å¯æœåŠ¡ http://${hostname}:${port}/`;
    console.log("ðŸš€ ~ msg", msg)
});

server.on('error', function(err) {
    console.log("ðŸš€ ~ err", err)
    if (err.code === 'EADDRINUSE') {
        console.log('ç«¯å£ã€' + port + 'ã€‘ å·²ç»è¢«ä½¿ç”¨')
    } else {
       
    }
});

server.on('request', async function(req, res) {
    const requestUrl = req.url;
    
    let data = [];
    req.on('data', chunk => {
        //reqå¯¹è±¡å¯åŠ¨dataæ–¹æ³•ï¼Œæ­¤æ–¹æ³•å°†ä¼šå¤šæ¬¡èŽ·å–æäº¤çš„æ•°æ®ï¼Œå¦‚æžœæäº¤çš„æ•°æ®é‡å¤§çš„è¯ã€‚
        data += chunk;
    });

    req.on('end', async () => {
        if(requestUrl === '/api/apitest/postElectronUpdate') {
            res.setHeader('Content-Type', 'text/plain;charset=UTF-8');
            console.log('ok')
            res.end(JSON.stringify( {
                "name": "app",
                "version": "1.1.3",
                "asar": "http://127.0.0.1:3176/update.zip",
                "info": "1.fix bug\n2.feat..."
            }));
        } else {
            var zip = fs.createReadStream(path.join(__dirname,'./update.zip'));
            res.writeHead(200, {
                'Content-Type': 'application/zip',
                'Content-Disposition': 'attachment; filename=update.zip'
            });
            zip.pipe(res);
        }
    });
});
```


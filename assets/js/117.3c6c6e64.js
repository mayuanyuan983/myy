(window.webpackJsonp=window.webpackJsonp||[]).push([[117],{533:function(s,a,n){"use strict";n.r(a);var e=n(62),t=Object(e.a)({},(function(){var s=this,a=s.$createElement,n=s._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h1",{attrs:{id:"linux-mysql安装-5-7解压版"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#linux-mysql安装-5-7解压版"}},[s._v("#")]),s._v(" Linux mysql安装 5.7解压版")]),s._v(" "),n("h2",{attrs:{id:"目录位置约定"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#目录位置约定"}},[s._v("#")]),s._v(" 目录位置约定")]),s._v(" "),n("p",[s._v("安装文件下载目录：/home/data/software")]),s._v(" "),n("p",[s._v("Mysql目录安装位置：/usr/local/mysql")]),s._v(" "),n("p",[s._v("数据库保存位置：/home/data/mysql")]),s._v(" "),n("h2",{attrs:{id:"安装文件上传"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#安装文件上传"}},[s._v("#")]),s._v(" 安装文件上传")]),s._v(" "),n("p",[n("code",[s._v("mkdir -p /home/data/software")])]),s._v(" "),n("ol",[n("li",[n("p",[s._v("新建安装文件下载目录")]),s._v(" "),n("p",[n("code",[s._v("mkdir -p /home/data/software")])])]),s._v(" "),n("li",[n("p",[s._v("新建数据库保存位置")]),s._v(" "),n("p",[n("code",[s._v("mkdir –p /home/data/mysql")])])])]),s._v(" "),n("h2",{attrs:{id:"解压安装包文件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#解压安装包文件"}},[s._v("#")]),s._v(" 解压安装包文件")]),s._v(" "),n("ol",[n("li",[n("p",[s._v("进入目录")]),s._v(" "),n("p",[n("code",[s._v("cd /home/data/software")])])]),s._v(" "),n("li",[n("p",[s._v("解压")]),s._v(" "),n("p",[n("code",[s._v("tar -xzvf mysql-5.7.24-linux-glibc2.12-x86_64.tar.gz")])])]),s._v(" "),n("li",[n("p",[s._v("移动目录并改名")]),s._v(" "),n("p",[n("code",[s._v("mv mysql-5.7.24-linux-glibc2.12-x86_64 /usr/local/mysql")])])])]),s._v(" "),n("h2",{attrs:{id:"新建mysql用户"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#新建mysql用户"}},[s._v("#")]),s._v(" 新建mysql用户")]),s._v(" "),n("ol",[n("li",[n("p",[s._v("新建用户组")]),s._v(" "),n("p",[n("code",[s._v("/usr/sbin/groupadd mysql")])])]),s._v(" "),n("li",[n("p",[s._v("新建用户 禁止登录ssh")]),s._v(" "),n("p",[n("code",[s._v("useradd -r -s /sbin/nologin -g mysql mysql -d /usr/local/mysql")])])])]),s._v(" "),n("h2",{attrs:{id:"目录赋权"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#目录赋权"}},[s._v("#")]),s._v(" 目录赋权")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("cd /usr/local/mysql\nchown -R mysql /usr/local/mysql/\nchgrp -R mysql /usr/local/mysql/\nchmod -R 755 /home/data/mysql #新增 看FAQ1\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("h2",{attrs:{id:"参数配置"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#参数配置"}},[s._v("#")]),s._v(" 参数配置")]),s._v(" "),n("p",[s._v("此处会生成临时密码，在结尾处，需记录")]),s._v(" "),n("p",[n("code",[s._v("bin/mysqld --initialize --user=mysql --basedir=/usr/local/mysql/ --datadir=/home/data/mysql/")])]),s._v(" "),n("p",[n("code",[s._v("bin/mysql_ssl_rsa_setup --datadir=/home/data/mysql/")])]),s._v(" "),n("h2",{attrs:{id:"修改my-cnf"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#修改my-cnf"}},[s._v("#")]),s._v(" 修改my.cnf")]),s._v(" "),n("p",[n("code",[s._v("cd /usr/local/mysql/support-files")])]),s._v(" "),n("p",[s._v("新建配置文件my.cnf")]),s._v(" "),n("p",[n("code",[s._v("cp my.cnf /etc/my.cnf")])]),s._v(" "),n("h3",{attrs:{id:"my-cnf文件内容"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#my-cnf文件内容"}},[s._v("#")]),s._v(" my.cnf文件内容")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("# For advice on how to change settings please see\n# http://dev.mysql.com/doc/refman/5.7/en/server-configuration-defaults.html\n# *** DO NOT EDIT THIS FILE. It's a template which will be copied to the\n# *** default location during install, and will be replaced if you\n# *** upgrade to a newer version of MySQL.\n[mysqld]\nsql_mode=NO_ENGINE_SUBSTITUTION,STRICT_TRANS_TABLES \n# 一般配置选项\nbasedir = /usr/local/mysql\ndatadir = /soft/data/mysql\nport = 3306\nsocket = /usr/local/mysql/mysqld.sock\ncharacter-set-server=utf8\n[client]\nport = 3306\nsocket = /usr/local/mysql/mysqld.sock\n#下面是可选项，要不要都行，如果出现启动错误，则全部注释掉，保留最基本的配置选项，然后尝试添加某些配置项后启动，检测配置项是否有误\n#back_log = 300\n#max_connections = 3000\n#max_connect_errors = 1000\n#table_open_cache = 4096\n#max_allowed_packet = 32M\n#binlog_cache_size = 4M\n#max_heap_table_size = 128M\n#read_rnd_buffer_size = 16M\n#sort_buffer_size = 16M\n#join_buffer_size = 16M\n#thread_cache_size = 16\n#query_cache_size = 128M\n#query_cache_limit = 4M\n#ft_min_word_len = 8\n#thread_stack = 512K\n#transaction_isolation = REPEATABLE-READ\n#tmp_table_size = 128M\n#log-bin=mysql-bin\n#long_query_time = 6\n#server_id=1\n#innodb_buffer_pool_size = 1G\n#innodb_thread_concurrency = 16\n#innodb_log_buffer_size = 16M\n#innodb_log_file_size = 512M\n#innodb_log_files_in_group = 3\n#innodb_max_dirty_pages_pct = 90\n#innodb_lock_wait_timeout = 120\n#innodb_file_per_table = on\n[mysqldump]\nquick\nmax_allowed_packet = 32M\n[mysql]\nno-auto-rehash\ndefault-character-set=utf8\nsafe-updates\n[myisamchk]\nkey_buffer = 16M\nsort_buffer_size = 16M\nread_buffer = 8M\nwrite_buffer = 8M\n[mysqlhotcopy]\ninteractive-timeout\n[mysqld_safe]\nopen-files-limit = 8192\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br")])]),n("p",[n("code",[s._v("cp mysql.server /etc/init.d/mysql")])]),s._v(" "),n("h2",{attrs:{id:"修改-etc-init-d-mysql"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#修改-etc-init-d-mysql"}},[s._v("#")]),s._v(" 修改/etc/init.d/mysql")]),s._v(" "),n("p",[n("code",[s._v("vim /etc/init.d/mysql")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("basedir=/usr/local/mysql\ndatadir=/home/data/mysql\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("h2",{attrs:{id:"启动"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#启动"}},[s._v("#")]),s._v(" 启动")]),s._v(" "),n("p",[n("code",[s._v("/etc/init.d/mysql start")])]),s._v(" "),n("h2",{attrs:{id:"登录"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#登录"}},[s._v("#")]),s._v(" 登录")]),s._v(" "),n("p",[n("code",[s._v("mysql -h localhost -u root -p")])]),s._v(" "),n("p",[s._v("如果出现-bash: mysql: command not found")]),s._v(" "),n("p",[s._v("执行"),n("code",[s._v("ln -s /usr/local/mysql/bin/mysql /usr/bin")])]),s._v(" "),n("p",[s._v("输入上面的临时密码")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("--修改密码\nmysql"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("password")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("password"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'密码'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n--授权\nmysql"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("grant all privileges on *.* to "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'用户'")]),s._v("@"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'%'")]),s._v(" identified by "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'密码'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nmysql"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("flush privileges"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n--查看表\nmysql"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" use mysql"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nmysql"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" host,user from user"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br")])]),n("h2",{attrs:{id:"添加系统路径"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#添加系统路径"}},[s._v("#")]),s._v(" 添加系统路径")]),s._v(" "),n("p",[n("code",[s._v("vim /etc/profile")])]),s._v(" "),n("p",[s._v("添加：")]),s._v(" "),n("p",[n("code",[s._v("export PATH=/usr/local/mysql/bin:$PATH")])]),s._v(" "),n("p",[s._v("重启："),n("code",[s._v("source /etc/profile")])]),s._v(" "),n("h2",{attrs:{id:"配置自启动"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#配置自启动"}},[s._v("#")]),s._v(" 配置自启动")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("755")]),s._v(" /etc/init.d/mysql\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("chkconfig")]),s._v(" --add mysql\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("chkconfig")]),s._v(" --level "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("345")]),s._v(" mysql on\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("h2",{attrs:{id:"faq"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#faq"}},[s._v("#")]),s._v(" FAQ")]),s._v(" "),n("h3",{attrs:{id:"_1-mysql启动报错"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-mysql启动报错"}},[s._v("#")]),s._v(" 1.mysql启动报错")]),s._v(" "),n("p",[s._v("​\tThe server quit without updating PID file (/usr/local/"),n("a",{attrs:{href:"https://edu.aliyun.com/jiaocheng/1107",target:"_blank",rel:"noopener noreferrer"}},[s._v("my"),n("OutboundLink")],1),n("a",{attrs:{href:"https://edu.aliyun.com/jiaocheng/1043",target:"_blank",rel:"noopener noreferrer"}},[s._v("sql"),n("OutboundLink")],1),s._v("/var/xxx.pid)")]),s._v(" "),n("p",[s._v("​\thttps://blog.csdn.net/zhou75771217/article/details/82893997")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("chown -R mysql:mysql /usr/local/mysql\nchmod -R 755 /home/data/mysql\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("h3",{attrs:{id:"_2-断电导致innodb损坏无法启动"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-断电导致innodb损坏无法启动"}},[s._v("#")]),s._v(" 2.断电导致innodb损坏无法启动")]),s._v(" "),n("p",[s._v("​\t尝试强制恢复")]),s._v(" "),n("p",[s._v("​\t在mysql的配置文件my.cnf里找到 [mysqld]字段下，添加 innodb_force_recovery=1：")]),s._v(" "),n("p",[s._v("​\tvim /etc/my.cnf")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("[mysqld]\ninnodb_force_recovery = 1\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("p",[s._v("​\t如果innodb_force_recovery = 1不生效，则可尝试2——6几个数字")]),s._v(" "),n("p",[s._v("​\t然后重启mysql，重启成功。然后使用mysqldump或 pma 导出数据，执行修复操作等。修复完成后，把该参数注释掉，还原默认值0。")]),s._v(" "),n("h4",{attrs:{id:"innodb-force-recovery参数解析"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#innodb-force-recovery参数解析"}},[s._v("#")]),s._v(" innodb_force_recovery参数解析")]),s._v(" "),n("p",[s._v("​\tinnodb_force_recovery影响整个InnoDB存储引擎的恢复状况。默认为0，表示当需要恢复时执行所有的恢复操作（即校验数据页/purge undo/insert buffer merge/rolling back&forward），当不能进行有效的恢复操作时，mysql有可能无法启动，并记录错误日志；\ninnodb_force_recovery可以设置为1-6,大的数字包含前面所有数字的影响。当设置参数值大于0后，可以对表进行select,create,drop操作,但insert,update或者delete这类操作是不允许的。")]),s._v(" "),n("ul",[n("li",[s._v("1(SRV_FORCE_IGNORE_CORRUPT):忽略检查到的corrupt页。")]),s._v(" "),n("li",[s._v("2(SRV_FORCE_NO_BACKGROUND):阻止主线程的运行，如主线程需要执行full purge操作，会导致crash。")]),s._v(" "),n("li",[s._v("3(SRV_FORCE_NO_TRX_UNDO):不执行事务回滚操作。")]),s._v(" "),n("li",[s._v("4(SRV_FORCE_NO_IBUF_MERGE):不执行插入缓冲的合并操作。")]),s._v(" "),n("li",[s._v("5(SRV_FORCE_NO_UNDO_LOG_SCAN):不查看重做日志，InnoDB存储引擎会将未提交的事务视为已提交。")]),s._v(" "),n("li",[s._v("6(SRV_FORCE_NO_LOG_REDO):不执行前滚的操作。")])])])}),[],!1,null,null,null);a.default=t.exports}}]);
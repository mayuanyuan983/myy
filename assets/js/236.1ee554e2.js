(window.webpackJsonp=window.webpackJsonp||[]).push([[236],{651:function(s,e,t){"use strict";t.r(e);var _=t(62),a=Object(_.a)({},(function(){var s=this,e=s.$createElement,t=s._self._c||e;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"ansible"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ansible"}},[s._v("#")]),s._v(" ansible")]),s._v(" "),t("h2",{attrs:{id:"_1-安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-安装"}},[s._v("#")]),s._v(" 1.安装")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://blog.csdn.net/wzt888_/article/details/81813728",target:"_blank",rel:"noopener noreferrer"}},[s._v("ansible的安装部署"),t("OutboundLink")],1)]),s._v(" "),t("p",[t("a",{attrs:{href:"https://note.youdao.com/ynoteshare/index.html?id=6f0fb3708239eb3df3eaa4ce84170428&type=note&_time=1644815405825",target:"_blank",rel:"noopener noreferrer"}},[s._v("离线安装"),t("OutboundLink")],1)]),s._v(" "),t("h2",{attrs:{id:"_2-资料"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-资料"}},[s._v("#")]),s._v(" 2.资料")]),s._v(" "),t("p",[s._v("1.教程")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://www.cnblogs.com/keerya/p/7987886.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("自动化运维工具——ansible详解（一）"),t("OutboundLink")],1)]),s._v(" "),t("p",[s._v("2.笔记")]),s._v(" "),t("p",[s._v("https://note.youdao.com/s/dj2j8Gv2")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://blog.csdn.net/df0128/article/details/90747560",target:"_blank",rel:"noopener noreferrer"}},[s._v("ansible传文件到远程copy和从远程机器拷贝文件fetch"),t("OutboundLink")],1)]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("ansible  "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v(" -m copy -a "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"src=/etc/ansible/polkit-0.112-26.el7_9.1.x86_64.rpm dest=/opt/  mode=0755"')]),s._v(" --become --become-method"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("su --become-user"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("root\n\n\nansible  "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v(" -m fetch -a "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"src=/opt/1.txt dest='),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${workspace}")]),s._v(' force=yes"')]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("h2",{attrs:{id:"_3-教程"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-教程"}},[s._v("#")]),s._v(" 3.教程")]),s._v(" "),t("p",[s._v("1.查看主机清单")]),s._v(" "),t("p",[t("code",[s._v("cat /etc/ansible/hosts")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("[test]\n192.168.1.100 ansible_ssh_user=test  ansible_ssh_pass=123456  ansible_su_pass=password\n192.168.1.[101:103] ansible_ssh_user=test  ansible_ssh_pass=123456 ansible_su_pass=password\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("2.参数详解")]),s._v(" "),t("table",[t("thead",[t("tr",[t("th",[s._v("参数")]),s._v(" "),t("th",[s._v("用途")]),s._v(" "),t("th",[s._v("示例")])])]),s._v(" "),t("tbody",[t("tr",[t("td",[s._v("ansible_ssh_host")]),s._v(" "),t("td",[s._v("定义hosts ssh 地址")]),s._v(" "),t("td",[s._v("ansible_ssh_host=192.169.1.100")])]),s._v(" "),t("tr",[t("td",[s._v("ansible_ssh_port")]),s._v(" "),t("td",[s._v("定义hosts ssh 端口")]),s._v(" "),t("td",[s._v("ansible_ssh_port=8000")])]),s._v(" "),t("tr",[t("td",[s._v("ansible_ssh_user")]),s._v(" "),t("td",[s._v("定义hosts ssh 认证用户")]),s._v(" "),t("td",[s._v("ansible_ssh_user=test")])]),s._v(" "),t("tr",[t("td",[s._v("ansible_ssh_pass")]),s._v(" "),t("td",[s._v("定义hosts ssh 认证密码")]),s._v(" "),t("td",[s._v("ansible_ssh_pass=123456")])]),s._v(" "),t("tr",[t("td",[s._v("ansible_sudo")]),s._v(" "),t("td",[s._v("定义hosts sudo 用户")]),s._v(" "),t("td",[s._v("ansible_sudo=www")])]),s._v(" "),t("tr",[t("td",[s._v("ansible_sudo_pass")]),s._v(" "),t("td",[s._v("定义hosts sudo 密码")]),s._v(" "),t("td",[s._v("ansible_sudo_pass=password")])]),s._v(" "),t("tr",[t("td",[s._v("ansible_sudo_exe")]),s._v(" "),t("td",[s._v("定义hosts sudo 路径")]),s._v(" "),t("td",[s._v("ansible_sudo_exe=/usr/bin/sudo")])]),s._v(" "),t("tr",[t("td",[s._v("ansible_connection")]),s._v(" "),t("td",[s._v("定义 hosts连接方式")]),s._v(" "),t("td",[s._v("ansible_connection=local")])]),s._v(" "),t("tr",[t("td",[s._v("ansible_ssh_private_key_file")]),s._v(" "),t("td",[s._v("定义hosts私钥")]),s._v(" "),t("td",[s._v("ansible_ssh_private_key_file=/root/key")])]),s._v(" "),t("tr",[t("td",[s._v("ansible_ssh_shell_type")]),s._v(" "),t("td",[s._v("定义hosts shell类型")]),s._v(" "),t("td",[s._v("ansible_ssh_shell_type=bash")])]),s._v(" "),t("tr",[t("td",[s._v("ansible_python_interpreter")]),s._v(" "),t("td",[s._v("定义hosts 任务执行python路径")]),s._v(" "),t("td",[s._v("ansible_python_interpreter=/usr/bin/python2.6")])]),s._v(" "),t("tr",[t("td",[t("code",[s._v("ansible_*_interpreter")])]),s._v(" "),t("td",[s._v("定义hosts 其他语言解析路径")]),s._v(" "),t("td",[t("code",[s._v("ansible_*_interpreter=/usr/bin/ruby")])])]),s._v(" "),t("tr",[t("td",[s._v("ansible_su_pass")]),s._v(" "),t("td",[s._v("定义root用户的密码")]),s._v(" "),t("td",[s._v("ansible_su_pass=password")])])])]),s._v(" "),t("p",[s._v("3.ping命令")]),s._v(" "),t("p",[s._v("测试所有服务器是否与控制机网络连通")]),s._v(" "),t("p",[t("code",[s._v("ansible all -m ping")])]),s._v(" "),t("p",[s._v("测试分组test的服务器是否与控制机网络连通")]),s._v(" "),t("p",[t("code",[s._v("ansible test-m ping")])]),s._v(" "),t("p",[s._v("4.date命令")]),s._v(" "),t("p",[s._v("查看服务器时间")]),s._v(" "),t("p",[t("code",[s._v('ansible test -m shell -a "date"')])]),s._v(" "),t("p",[s._v("5.hostname命令")]),s._v(" "),t("p",[s._v("显示系统的主机名称")]),s._v(" "),t("p",[t("code",[s._v('ansible test -m shell -a "hostname"')])]),s._v(" "),t("p",[s._v("6.查询防火墙")]),s._v(" "),t("p",[s._v("检查防火墙状态："),t("code",[s._v("systemctl status firewalld")])]),s._v(" "),t("p",[t("a",{attrs:{href:"https://www.cnblogs.com/marso/archive/2018/01/06/8214927.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("Centos 7 systemctl和防火墙firewalld命令"),t("OutboundLink")],1)]),s._v(" "),t("p",[t("code",[s._v('ansible test -m shell -a "systemctl status firewalld" --become --become-method=su --become-user=root')])]),s._v(" "),t("h2",{attrs:{id:"become"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#become"}},[s._v("#")]),s._v(" become")]),s._v(" "),t("h3",{attrs:{id:"_1-说明"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-说明"}},[s._v("#")]),s._v(" 1.说明")]),s._v(" "),t("p",[s._v("​\t\tAnsible允许你成为另一个用户，与登录到本机的用户或远程用户不同。这是使用现有的特权升级工具（privilege escalation tools）完成的，您可能已经使用或已经配置了这些工具，如sudo，su，pfexec，doas，pbrun，dzdo，ksu等。")]),s._v(" "),t("p",[s._v("说明：")]),s._v(" "),t("p",[s._v("（1）在1.9 Ansible之前，大多数情况下都允许使用sudo和有限的su来允许登录/远程用户成为不同的用户并执行任务，用第二个用户的权限创建资源。从1.9开始become代替旧的sudo / su，同时仍然向后兼容。这个新系统也使得添加诸如pbrun（Powerbroker），pfexec，dzdo（Centrify）等其他特权升级工具变得更加容易。")]),s._v(" "),t("p",[s._v("（2）变量和指令是独立的，即设置become_user并不是设置become。")]),s._v(" "),t("h3",{attrs:{id:"_2-使用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-使用"}},[s._v("#")]),s._v(" 2.使用")]),s._v(" "),t("h4",{attrs:{id:"_2-1become"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-1become"}},[s._v("#")]),s._v(" 2.1become")]),s._v(" "),t("p",[s._v("使用“true”或“yes”来表示启用这个特权")]),s._v(" "),t("p",[s._v("如：become=true，表示打开了become开关。")]),s._v(" "),t("h4",{attrs:{id:"_2-2become-user"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2become-user"}},[s._v("#")]),s._v(" 2.2become_user")]),s._v(" "),t("p",[s._v("become_user=root 设置为root账户，相当于我们以普通账户登入到远程主机时，再使用su - root切换为root账户。")]),s._v(" "),t("h4",{attrs:{id:"_2-3become-method"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-3become-method"}},[s._v("#")]),s._v(" 2.3become_method")]),s._v(" "),t("p",[s._v("become_method=su 表示用什么方式将普通账户切换到root或所需的其他账户，这里可以用su或sudo。")]),s._v(" "),t("h4",{attrs:{id:"_2-4become-flags"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-4become-flags"}},[s._v("#")]),s._v(" 2.4become_flags")]),s._v(" "),t("p",[s._v("表示允许为任务或角色使用特定的标志。一个常见的用法是在shell设置为不登录时将用户更改为nobody。ansible2.2版本中增加。")])])}),[],!1,null,null,null);e.default=a.exports}}]);
(window.webpackJsonp=window.webpackJsonp||[]).push([[32],{445:function(s,a,t){"use strict";t.r(a);var n=t(62),e=Object(n.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"openfeign"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#openfeign"}},[s._v("#")]),s._v(" openFeign")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://www.cnblogs.com/cbvlog/p/15322926.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("openFeign夺命连环9问，这谁受得了？ - bucaichenmou - 博客园 (cnblogs.com)"),t("OutboundLink")],1)]),s._v(" "),t("h2",{attrs:{id:"什么是feign"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#什么是feign"}},[s._v("#")]),s._v(" 什么是Feign")]),s._v(" "),t("p",[s._v("Feign 集成了Ribbon、RestTemplate实现了负载均衡的执行Http调用，并对其进行了封装。Feign通过定义一个接口，标注注解即可完成服务调用。")]),s._v(" "),t("p",[s._v("已停止迭代。")]),s._v(" "),t("h2",{attrs:{id:"什么是openfeign"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#什么是openfeign"}},[s._v("#")]),s._v(" 什么是openFeign")]),s._v(" "),t("p",[s._v("openFeign是SpringCloud在Feign的基础上支持了SpringMVC的注解，如"),t("code",[s._v("RequestMapping")]),s._v("等。openFeign的"),t("code",[s._v("FeignClient")]),s._v("可以解析SpringMVC的"),t("code",[s._v("RequestMapping")]),s._v("注解下的接口，并通过动态代理的方式产生实现类，实现类中做负载均衡并调用其他服务。")]),s._v(" "),t("h2",{attrs:{id:"使用openfeign"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#使用openfeign"}},[s._v("#")]),s._v(" 使用openFeign")]),s._v(" "),t("p",[s._v("TODO")]),s._v(" "),t("h2",{attrs:{id:"openfeign传参方式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#openfeign传参方式"}},[s._v("#")]),s._v(" openFeign传参方式")]),s._v(" "),t("p",[s._v("TODO")]),s._v(" "),t("h2",{attrs:{id:"文件传输"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#文件传输"}},[s._v("#")]),s._v(" 文件传输")]),s._v(" "),t("p",[s._v("TODO")]),s._v(" "),t("h2",{attrs:{id:"超时时间"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#超时时间"}},[s._v("#")]),s._v(" 超时时间")]),s._v(" "),t("p",[s._v("openFeign默认：连接超时时间10秒、读超时时间60秒")]),s._v(" "),t("p",[s._v("openFeign集成了Ribbon，Ribbon的默认时间均为1秒")]),s._v(" "),t("p",[s._v("如果oepnFeign未设置超时时间，将采取Ribbon的默认超时时间。")]),s._v(" "),t("p",[s._v("1.设置openFeign超时时间【推荐】")]),s._v(" "),t("div",{staticClass:"language-yml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("feign")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("client")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("config")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## default 设置的全局超时时间，指定服务名称可以设置单个服务的超时时间")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("default")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("connectTimeout")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5000")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("readTimeout")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5000")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("p",[s._v("default设置的是全局超时时间，对所有的openFeign接口服务都生效")]),s._v(" "),t("p",[s._v("为服务单独配置超时时间。单个配置的超时时间将会覆盖全局配置。")]),s._v(" "),t("div",{staticClass:"language-yml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("feign")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("client")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("config")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## default 设置的全局超时时间，指定服务名称可以设置单个服务的超时时间")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("default")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("connectTimeout")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5000")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("readTimeout")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5000")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 为serviceC这个服务单独配置超时时间")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("serviceC")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("connectTimeout")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("30000")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("readTimeout")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("30000")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br")])]),t("p",[s._v("2.设置Ribbon超时时间【不推荐】")]),s._v(" "),t("div",{staticClass:"language-yml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ribbon")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 值的是建立链接所用的时间，适用于网络状况正常的情况下， 两端链接所用的时间")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ReadTimeout")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5000")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 指的是建立链接后从服务器读取可用资源所用的时间")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ConectTimeout")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5000")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("h2",{attrs:{id:"日志增强"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#日志增强"}},[s._v("#")]),s._v(" 日志增强")]),s._v(" "),t("p",[s._v("默认不显示任何日志，开发者可在调试阶段可以配置日志级别。")]),s._v(" "),t("p",[s._v("openFeign的日志级别如下：")]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("NONE")]),s._v("：默认的，不显示任何日志;")]),s._v(" "),t("li",[t("strong",[s._v("BASIC")]),s._v("：仅记录请求方法、URL、响应状态码及执行时间;")]),s._v(" "),t("li",[t("strong",[s._v("HEADERS")]),s._v("：除了BASIC中定义的信息之外，还有请求和响应的头信息;")]),s._v(" "),t("li",[t("strong",[s._v("FULL")]),s._v("：除了HEADERS中定义的信息之外，还有请求和响应的正文及元数据。")])]),s._v(" "),t("p",[s._v("配置方式")]),s._v(" "),t("p",[s._v("1.配置类中配置日志级别")]),s._v(" "),t("p",[s._v("需要自定义一个配置类，在其中设置日志级别")]),s._v(" "),t("p",[s._v("注意：这里的Logger是feign包里的")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("feign"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Logger")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("org"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("springframework"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("context"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("annotation"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Bean")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("org"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("springframework"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("context"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("annotation"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Configuration")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Configuration")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("OpenFeignConfig")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    \n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n     * 日志级别定义\n     * return\n     */")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Bean")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Logger")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("level "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("feignLoggerLevel")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Logger"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Level")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("FULL"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br")])]),t("p",[s._v("2.配置文件中设置接口日志级别")]),s._v(" "),t("p",[s._v("这里的"),t("code",[s._v("cn.myjszl.service")]),s._v("是openFeign接口所在的包名，当然你也可以配置一个特定的openFeign接口。")]),s._v(" "),t("div",{staticClass:"language-yml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("logging")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("level")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("cn.myjszl.service")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" debug\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("h2",{attrs:{id:"通讯优化-gzip压缩"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#通讯优化-gzip压缩"}},[s._v("#")]),s._v(" 通讯优化--gzip压缩")]),s._v(" "),t("p",[t("strong",[s._v("注意")]),s._v("：openFeign支持的GZIP仅仅是在openFeign接口的请求和响应，即是openFeign消费者调用服务提供者的接口。")]),s._v(" "),t("div",{staticClass:"language-yml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("feign")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 开启压缩")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("compression")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("request")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("enabled")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("true")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 开启压缩的阈值，单位字节，默认2048，即是2k，这里为了演示效果设置成10字节")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("min-request-size")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("mime-types")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" text/xml"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("application/xml"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("application/json\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("response")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("enabled")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("true")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br")])]),t("h2",{attrs:{id:"替换默认httpclient"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#替换默认httpclient"}},[s._v("#")]),s._v(" 替换默认httpClient")]),s._v(" "),t("p",[s._v("TODO")]),s._v(" "),t("h2",{attrs:{id:"熔断降级"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#熔断降级"}},[s._v("#")]),s._v(" 熔断降级")]),s._v(" "),t("p",[s._v("Sentinel")]),s._v(" "),t("p",[s._v("TODO")])])}),[],!1,null,null,null);a.default=e.exports}}]);